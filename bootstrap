#!/bin/bash
set -x
set -e
if [[ `uname` = Darwin ]] 
then
    # This uses locally-installed libtoolize and automake since the apple-supplied one is buggy
    # as of OS X 10.4.7
    ../bin/libtoolize --copy --force
    ../bin/aclocal -I m4
    # Patch that fixes 'absolute addressing not allowed in slidable image' linker error.
    patch < mac/libtool.m4.patch m4/libtool.m4 
    ../bin/automake --foreign --add-missing --copy 
    autoconf
else
    libtoolize --copy --force
    aclocal -I m4
    automake --foreign --add-missing --copy 
    autoconf
fi
